{% extends 'hospital/base.html' %}

{% block title %}Dashboard - King Faisal Hospital{% endblock %}

{% block content %}
<div class="hero-section" style="padding: 40px 0;">
    <div class="container">
        <h1><i class="fas fa-tachometer-alt"></i> Healthcare Dashboard</h1>
        <p class="lead">Real-time overview of patient health data and system statistics</p>
    </div>
</div>

<div class="container mt-4 mb-5">
    <div class="row mb-4">
        <div class="col-lg-3 col-md-6 mb-3">
            <div class="stat-card">
                <div class="d-flex justify-content-between align-items-center">
                    <div>
                        <div style="color: #666;">Total Patients</div>
                        <div style="font-size: 2.5rem; font-weight: bold; color: #0066cc;">{{ total_patients }}</div>
                    </div>
                    <div style="font-size: 3rem; color: #0066cc;">
                        <i class="fas fa-users"></i>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="col-lg-3 col-md-6 mb-3">
            <div class="stat-card">
                <div class="d-flex justify-content-between align-items-center">
                    <div>
                        <div style="color: #666;">Vital Records</div>
                        <div style="font-size: 2.5rem; font-weight: bold; color: #00a651;">{{ total_vitals }}</div>
                    </div>
                    <div style="font-size: 3rem; color: #00a651;">
                        <i class="fas fa-heartbeat"></i>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="col-lg-3 col-md-6 mb-3">
            <div class="stat-card">
                <div class="d-flex justify-content-between align-items-center">
                    <div>
                        <div style="color: #666;">High Heart Rate</div>
                        <div style="font-size: 2.5rem; font-weight: bold; color: #dc3545;">{{ high_hr_count }}</div>
                    </div>
                    <div style="font-size: 3rem; color: #dc3546de;">
                        <i class="fas fa-exclamation-triangle"></i>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="col-lg-3 col-md-6 mb-3">
            <div class="stat-card">
                <div class="d-flex justify-content-between align-items-center">
                    <div>
                        <div style="color: #575656;">Fever Cases</div>
                        <div style="font-size: 2.5rem; font-weight: bold; color: #ffc107;">{{ fever_count }}</div>
                    </div>
                    <div style="font-size: 3rem; color: #ffc107;">
                        <i class="fas fa-temperature-high"></i>
                    </div>
                </div>
            </div>
        </div>
        
    </div>

<!-- Critical Patients -->
    <div class="row mb-4">
    <!-- Critical Patients -->
    <div class="col-lg-3 col-md-6 mb-3">
        <div class="stat-card">
            <div class="d-flex justify-content-between align-items-center">
                <div>
                    <div style="color: #666;">Critical Patients</div>
                    <div style="font-size: 2.5rem; font-weight: bold; color: #dc3545;">{{ critical_count }}</div>
                </div>
                <div style="font-size: 3rem; color: #dc3545;">
                    <i class="fas fa-exclamation-circle"></i>
                </div>
            </div>
        </div>
    </div>

    <!-- Elderly Patients -->
    <div class="col-lg-3 col-md-6 mb-3">
        <div class="stat-card">
            <div class="d-flex justify-content-between align-items-center">
                <div>
                    <div style="color: #666;">Elderly Patients (60+)</div>
                    <div style="font-size: 2.5rem; font-weight: bold; color: #6c757d;">{{ elderly_count }}</div>
                </div>
                <div style="font-size: 3rem; color: #6c757d;">
                    <i class="fas fa-user-clock"></i>
                </div>
            </div>
        </div>
    </div>
</div>
    
    <div class="row mb-4">
        <div class="col-12">
            <div class="stat-card">
                <h4 class="mb-3"><i class="fas fa-bolt"></i> Quick Actions</h4>
                <div class="row">
                    <div class="col-md-3 mb-2">
                        <a href="{% url 'hospital:analytics' %}" class="btn w-100" style="background: #5ca3ff; color: white; padding: 14px; border-radius: 8px; font-weight: 600; font-size: 1rem; border: none;">
                            <i class="fas fa-chart-line"></i> View Analytics
                        </a>
                    </div>
                    <div class="col-md-3 mb-2">
                        <a href="{% url 'admin:hospital_patient_add' %}" class="btn w-100" style="background: #5ca3ff; color: white; padding: 14px; border-radius: 8px; font-weight: 600; font-size: 1rem; border: none;">
                            <i class="fas fa-user-plus"></i> Add Patient
                        </a>
                    </div>
                    <div class="col-md-3 mb-2">
                        <a href="{% url 'admin:hospital_vitalsign_add' %}" class="btn w-100" style="background: #5ca3ff; color: white; padding: 14px; border-radius: 8px; font-weight: 600; font-size: 1rem; border: none;">
                            <i class="fas fa-heartbeat"></i> Record Vitals
                        </a>
                    </div>
                    <div class="col-md-3 mb-2">
                        <a href="{% url 'hospital:generate_sample_data' %}" class="btn w-100" style="background: white; color: #0066cc; padding: 14px; border-radius: 8px; font-weight: 600; font-size: 1rem; border: 2px solid #0066cc;">
                            <i class="fas fa-database"></i> Generate Sample Data
                        </a>
                    </div>
                    <div class="col-md-3 mb-2">
                       <a href="{% url 'hospital:elderly_count' %}" class="btn w-100"  style="background: #6c757d; color: white; padding: 14px; border-radius: 8px; 
                            font-weight: 600; font-size: 1rem; border: none;">
                              <i class="fas fa-user-clock"></i> Elderly Count
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <div class="row">
        <div class="col-12">
            <div class="stat-card">
                <h4 class="mb-3"><i class="fas fa-users"></i> Recent Patients</h4>
                
                {% if recent_patients %}
                <div class="table-responsive">
    <table class="table table-hover">
        <thead style="background: #f8f9fa;">
            <tr>
                <th>Patient ID</th>
                <th>Name</th>
                <th>Gender</th>
                <th>Phone</th>
                <th>Risk Level</th>
                <th>Registered</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody>
            {% for patient in recent_patients %}
            <tr>
                <td><strong>{{ patient.patient_id }}</strong></td>
                <td>{{ patient.first_name }} {{ patient.last_name }}</td>
                <td>
                    {% if patient.gender == 'M' %}
                        <span class="badge bg-primary">Male</span>
                    {% else %}
                        <span class="badge bg-danger">Female</span>
                    {% endif %}
                </td>
                <td>{{ patient.phone }}</td>
                <td>
                    <span class="badge bg-{{ patient.get_latest_risk_color }}">
                        <i class="fas fa-heartbeat"></i> {{ patient.get_latest_risk_level }}
                    </span>
                </td>
                <td>{{ patient.created_at|date:"M d, Y" }}</td>
                <td>
                    <a href="{% url 'hospital:patient_detail' patient.patient_id %}" class="btn btn-sm" style="background: #e3f2fd; color: #0066cc; border: 1px solid #0066cc;">
                        <i class="fas fa-eye"></i> View
                    </a>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
                {% else %}
                <div class="alert alert-info">
                    <i class="fas fa-info-circle"></i> No patients registered yet. 
                    <a href="{% url 'hospital:generate_sample_data' %}" style="font-weight: bold;">Generate sample data</a> to get started!
                </div>
                {% endif %}
            </div>
        </div>
    </div>
    
    <div class="row mt-4">
        <div class="col-md-6">
            <div class="stat-card">
                <h5><i class="fas fa-info-circle"></i> System Information</h5>
                <p class="mb-1"><strong>Logged in as:</strong> {{ user.username }}</p>
                <p class="mb-1"><strong>User Type:</strong> 
                    {% if user.is_superuser %}
                        <span class="badge bg-danger">Administrator</span>
                    {% else %}
                        <span class="badge bg-primary">Staff</span>
                    {% endif %}
                </p>
                <p class="mb-0"><strong>Last Login:</strong> {{ user.last_login|date:"M d, Y H:i" }}</p>
            </div>
        </div>
        <div class="col-md-6">
            <div class="stat-card">
                <h5><i class="fas fa-question-circle"></i> Need Help?</h5>
                <p>Access the admin panel to manage patients, vital signs, and system settings.</p>
                <a href="{% url 'admin:index' %}" class="btn" style="background: #5ca3ff; color: white; padding: 10px 25px; border-radius: 6px;">
                    <i class="fas fa-cog"></i> Go to Admin Panel
                </a>
            </div>
        </div>
    </div>
</div>
{% endblock %}
